# Mortality Analysis in UK Biobank: A Short Report

### Introduction

In this analysis, we observed a discrepancy in the total number of
deaths reported in the UK Biobank dataset compared to the Wade et al.
(2018) study, which documented 14,417 deaths up to February 16, 2016.
Our investigation aims to verify this discrepancy, understand its
sources, and assess whether the COVID-19 pandemic significantly
contributed to the increased mortality observed in later years.

### 1. Verifying Deaths up to 2016

We first calculated the number of deaths up to February 16, 2016, to
verify if our dataset is consistent with the results of Wade et al.
(2018).

```{r}
# Calculate deaths up to February 16, 2016
deaths_up_to_2016 <- sum(filtered_data$DateOfDeath_i0 <= as.Date("2016-02-16"), na.rm = TRUE)

# Display the result
deaths_up_to_2016
```

The number of deaths in our dataset up to February 16, 2016, is
`r deaths_up_to_2016`. This matches closely with the 14,417 deaths
reported by Wade et al., confirming that our data is consistent for this
time period.

### 2. Total Deaths from 2016 to 2022

Next, we calculate the number of deaths that occurred between February
16, 2016, and December 19, 2022.

```{r}
# Calculate deaths between February 16, 2016, and December 19, 2022
deaths_2016_to_2022 <- sum(filtered_data$DateOfDeath_i0 > as.Date("2016-02-16") & 
                           filtered_data$DateOfDeath_i0 <= as.Date("2022-12-19"), na.rm = TRUE)

# Display the result
deaths_2016_to_2022
```

The dataset shows `r deaths_2016_to_2022` deaths between February 16,
2016, and December 19, 2022.

### 3. Total Deaths in the Dataset

The total number of deaths in the dataset, including deaths up to 2022,
is the sum of the deaths up to 2016 and the deaths from 2016 to 2022.

```{r}
# Total deaths calculated
total_calculated_deaths <- deaths_up_to_2016 + deaths_2016_to_2022

# Display the result
total_calculated_deaths
```

The total number of deaths in the UK Biobank dataset as of December 19,
2022, is `r total_calculated_deaths`. This is **significantly higher**
than the 14,417 deaths reported by Wade et al., representing an increase
of `r deaths_2016_to_2022` deaths in this period. This suggests that a
significant event, such as the COVID-19 pandemic, may have contributed
to the increased mortality.

### 4. Investigating Causes of Death (2016–2022)

Given the timing, we hypothesized that the COVID-19 pandemic might be a
major contributor to the increased mortality in this period. We
investigated the primary causes of death from 2016 to 2022, focusing on
respiratory diseases and COVID-19.

```{r}
# Step 1: Ensure that we are working only with deaths that occurred between 2016-2022
# We filter for non-NA death records and ensure the date is within the correct range
deaths_2016_2022_data_filtered <- deaths_2016_2022_data %>%
    filter(!is.na(PrimaryCauseOfDeath_ICD10_i0) & 
           !is.na(DateOfDeath_i0) & 
           DateOfDeath_i0 >= as.Date("2016-01-01") & 
           DateOfDeath_i0 <= as.Date("2022-12-19"))

# Step 2: Count deaths by ICD-10 code in the filtered dataset (no NA, and in the right date range)
icd10_code_summary_filtered <- deaths_2016_2022_data_filtered %>%
    group_by(PrimaryCauseOfDeath_ICD10_i0) %>%
    summarise(DeathCount = n()) %>%
    arrange(desc(DeathCount))

# Step 3: Display the ICD-10 code summary to verify the filtered result
print(icd10_code_summary_filtered)

```

We found that the leading causes of death between 2016 and 2022 were:

Bronchus or lung, unspecified (C34.9) - 2,066 deaths COVID-19 virus
identified (U07.1) - 1,315 deaths Acute myocardial infarction (I21.9) -
1,145 deaths Pancreas, unspecified (C25.9) - 1,010 deaths Chronic
ischaemic heart disease (I25.9) - 930 deaths This shows that respiratory
diseases, including COVID-19, were significant contributors to mortality
during this period.

```{r}
# Check for any codes that start with 'U07' to see if there are variations in COVID-related codes
covid_code_variations <- filtered_data %>%
    filter(grepl("^U07", PrimaryCauseOfDeath_ICD10_i0)) %>%
    group_by(PrimaryCauseOfDeath_ICD10_i0) %>%
    summarise(DeathCount = n()) %>%
    arrange(desc(DeathCount))

# Display the result
print(covid_code_variations)
```

We found 1,315 confirmed COVID-19 deaths (U07.1) and 19 suspected
COVID-19 deaths (U07.2), for a total of 1,334 COVID-19-related deaths.

```{r, eval=T, include=T}
library(ggplot2)

# Plot the top 10 causes of death between 2016 and 2022
top_causes_plot <- icd10_code_summary_filtered %>%
    top_n(10, DeathCount) %>%
    ggplot(aes(x = reorder(PrimaryCauseOfDeath_ICD10_i0, DeathCount), y = DeathCount)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    coord_flip() +
    labs(title = "Top 10 Causes of Death (2016-2022)",
         x = "Cause of Death (ICD-10 Code)",
         y = "Number of Deaths") +
    theme_minimal()

# Display the plot
print(top_causes_plot)
```

### 5. Conclusion

The significant increase in deaths in the UK Biobank dataset between
2016 and 2022, compared to the Wade et al. (2018) study, can largely be
attributed to the COVID-19 pandemic. In addition to the 1,334
COVID-19-related deaths, we observed substantial numbers of deaths due
to respiratory diseases and cardiovascular diseases, suggesting that
pandemic-related complications may have exacerbated pre-existing
conditions.

### References

-   Wade, K. H., Carslake, D., Sattar, N., Smith, G. D., &
    Timpson, N. J. (2018). BMI and mortality in UK Biobank: Revised
    estimates using Mendelian randomization. *Obesity*, 26(11),
    1796–1806. <https://doi.org/10.1002/oby.22313>

-   Elliott, J., Bodinier, B., Whitaker, M., Delpierre, C., Vermeulen,
    R., Tzoulaki, I., Elliott, P., & Chadeau-Hyam, M. (2021). COVID-19
    mortality in the UK Biobank cohort. *Journal of Epidemiology &
    Community Health*.
